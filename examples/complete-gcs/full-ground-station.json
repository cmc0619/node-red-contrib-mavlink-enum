[
    {
        "id": "gcs_flow",
        "type": "tab",
        "label": "Complete Ground Control Station",
        "disabled": false,
        "info": "Full-featured GCS combining all capabilities.\n\nRequires: node-red-dashboard, mavlink-comms configured"
    },
    {
        "id": "mavlink_hub",
        "type": "junction",
        "z": "gcs_flow",
        "name": "MAVLink Hub",
        "x": 150,
        "y": 300,
        "wires": [["route_telemetry", "safety_monitor_input"]]
    },
    {
        "id": "route_telemetry",
        "type": "switch",
        "z": "gcs_flow",
        "name": "Route by Message Type",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {"t": "eq", "v": "HEARTBEAT", "vt": "str"},
            {"t": "eq", "v": "GPS_RAW_INT", "vt": "str"},
            {"t": "eq", "v": "SYS_STATUS", "vt": "str"},
            {"t": "eq", "v": "GLOBAL_POSITION_INT", "vt": "str"},
            {"t": "eq", "v": "VFR_HUD", "vt": "str"},
            {"t": "eq", "v": "ATTITUDE", "vt": "str"}
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 360,
        "y": 300,
        "wires": [
            ["parse_heartbeat"],
            ["parse_gps"],
            ["parse_sys_status"],
            ["parse_global_position"],
            ["parse_vfr_hud"],
            ["parse_attitude"]
        ]
    },
    {
        "id": "parse_heartbeat",
        "type": "function",
        "z": "gcs_flow",
        "name": "Parse HEARTBEAT",
        "func": "const hb = msg.payload;\nif (!hb) return null;\n\nconst armed = (hb.baseMode & 128) !== 0;\nconst armedText = armed ? \"ARMED\" : \"DISARMED\";\nconst armedColor = armed ? \"red\" : \"green\";\n\nconst modes = {\n    0: 'STABILIZE', 1: 'ACRO', 2: 'ALT_HOLD', 3: 'AUTO',\n    4: 'GUIDED', 5: 'LOITER', 6: 'RTL', 7: 'CIRCLE',\n    9: 'LAND', 11: 'DRIFT', 13: 'SPORT', 14: 'FLIP',\n    15: 'AUTOTUNE', 16: 'POSHOLD', 17: 'BRAKE', 18: 'THROW',\n    19: 'AVOID_ADSB', 20: 'GUIDED_NOGPS', 21: 'SMART_RTL',\n    22: 'FLOWHOLD', 23: 'FOLLOW', 24: 'ZIGZAG', 25: 'SYSTEMID',\n    26: 'AUTOROTATE', 27: 'AUTO_RTL'\n};\n\nconst modeName = modes[hb.customMode] || `UNKNOWN (${hb.customMode})`;\n\nreturn [\n    { payload: armedText, color: armedColor },\n    { payload: modeName }\n];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 590,
        "y": 100,
        "wires": [["ui_armed_status"], ["ui_flight_mode"]]
    },
    {
        "id": "parse_gps",
        "type": "function",
        "z": "gcs_flow",
        "name": "Parse GPS",
        "func": "const gps = msg.payload;\nif (!gps) return null;\n\nconst fixTypes = ['NO GPS', 'NO FIX', '2D FIX', '3D FIX', 'DGPS', 'RTK FLOAT', 'RTK FIXED'];\nconst fixName = fixTypes[gps.fixType] || `UNKNOWN (${gps.fixType})`;\nconst satellites = gps.satellitesVisible || 0;\nconst fixColor = gps.fixType >= 3 ? 'green' : (gps.fixType >= 2 ? 'yellow' : 'red');\n\nconst lat = gps.lat / 1e7;\nconst lon = gps.lon / 1e7;\nconst alt = gps.alt / 1000;  // mm to m\n\nreturn [\n    { payload: `${fixName} (${satellites} sats)`, color: fixColor },\n    { payload: lat.toFixed(6) },\n    { payload: lon.toFixed(6) },\n    { payload: alt.toFixed(1) }\n];",
        "outputs": 4,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 580,
        "y": 160,
        "wires": [
            ["ui_gps_status"],
            ["ui_latitude"],
            ["ui_longitude"],
            ["ui_gps_altitude"]
        ]
    },
    {
        "id": "parse_sys_status",
        "type": "function",
        "z": "gcs_flow",
        "name": "Parse SYS_STATUS",
        "func": "const sys = msg.payload;\nif (!sys) return null;\n\nconst batteryPercent = sys.batteryRemaining || 0;\nconst voltage = sys.voltageBattery ? sys.voltageBattery / 1000 : 0;\nconst current = sys.currentBattery ? sys.currentBattery / 100 : 0;\n\nlet battColor = 'green';\nif (batteryPercent < 20) battColor = 'red';\nelse if (batteryPercent < 30) battColor = 'orange';\nelse if (batteryPercent < 50) battColor = 'yellow';\n\nreturn [\n    { payload: batteryPercent },\n    { payload: voltage.toFixed(2) },\n    { payload: current.toFixed(2) },\n    { payload: battColor }\n];",
        "outputs": 4,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 600,
        "y": 220,
        "wires": [
            ["ui_battery_gauge"],
            ["ui_voltage"],
            ["ui_current"],
            []
        ]
    },
    {
        "id": "parse_global_position",
        "type": "function",
        "z": "gcs_flow",
        "name": "Parse Position",
        "func": "const pos = msg.payload;\nif (!pos) return null;\n\nconst relativeAlt = pos.relativeAlt ? pos.relativeAlt / 1000 : 0;\n\nreturn { payload: relativeAlt.toFixed(1) };",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 590,
        "y": 280,
        "wires": [["ui_altitude_gauge"]]
    },
    {
        "id": "parse_vfr_hud",
        "type": "function",
        "z": "gcs_flow",
        "name": "Parse VFR_HUD",
        "func": "const vfr = msg.payload;\nif (!vfr) return null;\n\nconst groundspeed = (vfr.groundspeed * 3.6).toFixed(1);  // m/s to km/h\nconst heading = vfr.heading || 0;\nconst throttle = vfr.throttle || 0;\nconst climb = vfr.climb.toFixed(1);\n\nreturn [\n    { payload: groundspeed },\n    { payload: heading },\n    { payload: throttle },\n    { payload: climb }\n];",
        "outputs": 4,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 600,
        "y": 340,
        "wires": [
            ["ui_groundspeed"],\n            ["ui_heading_gauge"],\n            ["ui_throttle_gauge"],\n            ["ui_climb_rate"]
        ]
    },
    {
        "id": "parse_attitude",
        "type": "function",
        "z": "gcs_flow",
        "name": "Parse ATTITUDE",
        "func": "const att = msg.payload;\nif (!att) return null;\n\nconst roll = (att.roll * 180 / Math.PI).toFixed(1);\nconst pitch = (att.pitch * 180 / Math.PI).toFixed(1);\nconst yaw = (att.yaw * 180 / Math.PI).toFixed(1);\n\nreturn [\n    { payload: roll },\n    { payload: pitch },\n    { payload: yaw }\n];",
        "outputs": 3,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 590,
        "y": 400,
        "wires": [["ui_roll"], ["ui_pitch"], ["ui_yaw"]]
    },
    {
        "id": "btn_arm",
        "type": "ui_button",
        "z": "gcs_flow",
        "name": "ARM",
        "group": "control_group",
        "order": 1,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "ARM",
        "tooltip": "Arm motors",
        "color": "",
        "bgcolor": "red",
        "className": "",
        "icon": "warning",
        "payload": "{\"messageType\":\"COMMAND_LONG\",\"command\":400,\"param1\":1,\"target_system\":1,\"target_component\":1}",
        "payloadType": "json",
        "topic": "",
        "topicType": "str",
        "x": 130,
        "y": 60,
        "wires": [["command_output"]]
    },
    {
        "id": "btn_disarm",
        "type": "ui_button",
        "z": "gcs_flow",
        "name": "DISARM",
        "group": "control_group",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "DISARM",
        "tooltip": "Disarm motors",
        "color": "",
        "bgcolor": "green",
        "className": "",
        "icon": "done",
        "payload": "{\"messageType\":\"COMMAND_LONG\",\"command\":400,\"param1\":0,\"target_system\":1,\"target_component\":1}",
        "payloadType": "json",
        "topic": "",
        "topicType": "str",
        "x": 140,
        "y": 100,
        "wires": [["command_output"]]
    },
    {
        "id": "btn_takeoff",
        "type": "ui_button",
        "z": "gcs_flow",
        "name": "TAKEOFF",
        "group": "control_group",
        "order": 3,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "TAKEOFF",
        "tooltip": "Takeoff to 10m",
        "color": "",
        "bgcolor": "blue",
        "className": "",
        "icon": "flight_takeoff",
        "payload": "{\"messageType\":\"COMMAND_LONG\",\"command\":22,\"param7\":10,\"target_system\":1,\"target_component\":1}",
        "payloadType": "json",
        "topic": "",
        "topicType": "str",
        "x": 140,
        "y": 140,
        "wires": [["command_output"]]
    },
    {
        "id": "btn_land",
        "type": "ui_button",
        "z": "gcs_flow",
        "name": "LAND",
        "group": "control_group",
        "order": 4,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "LAND",
        "tooltip": "Land at current position",
        "color": "",
        "bgcolor": "orange",
        "className": "",
        "icon": "flight_land",
        "payload": "{\"messageType\":\"COMMAND_LONG\",\"command\":21,\"target_system\":1,\"target_component\":1}",
        "payloadType": "json",
        "topic": "",
        "topicType": "str",
        "x": 130,
        "y": 180,
        "wires": [["command_output"]]
    },
    {
        "id": "btn_rtl",
        "type": "ui_button",
        "z": "gcs_flow",
        "name": "RTL",
        "group": "control_group",
        "order": 5,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "RTL",
        "tooltip": "Return to launch",
        "color": "",
        "bgcolor": "purple",
        "className": "",
        "icon": "home",
        "payload": "{\"messageType\":\"COMMAND_LONG\",\"command\":20,\"target_system\":1,\"target_component\":1}",
        "payloadType": "json",
        "topic": "",
        "topicType": "str",
        "x": 130,
        "y": 220,
        "wires": [["command_output"]]
    },
    {
        "id": "ui_mode_selector",
        "type": "ui_dropdown",
        "z": "gcs_flow",
        "name": "Mode Select",
        "label": "Flight Mode",
        "tooltip": "Change flight mode",
        "group": "control_group",
        "order": 6,
        "width": 4,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {"label": "STABILIZE", "value": 0},
            {"label": "ALT_HOLD", "value": 2},
            {"label": "GUIDED", "value": 4},
            {"label": "LOITER", "value": 5},
            {"label": "RTL", "value": 6},
            {"label": "AUTO", "value": 3},
            {"label": "LAND", "value": 9},
            {"label": "POSHOLD", "value": 16}
        ],
        "payload": "",
        "topic": "mode",
        "topicType": "str",
        "className": "",
        "x": 150,
        "y": 260,
        "wires": [["build_set_mode"]]
    },
    {
        "id": "build_set_mode",
        "type": "function",
        "z": "gcs_flow",
        "name": "Build SET_MODE",
        "func": "msg.payload = {\n    messageType: \"COMMAND_LONG\",\n    command: 176,  // MAV_CMD_DO_SET_MODE\n    param1: 1,     // MAV_MODE_FLAG_CUSTOM_MODE_ENABLED\n    param2: msg.payload,  // Custom mode number\n    target_system: 1,\n    target_component: 1\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 360,
        "y": 260,
        "wires": [["command_output"]]
    },
    {
        "id": "command_output",
        "type": "junction",
        "z": "gcs_flow",
        "name": "Command Output",
        "x": 570,
        "y": 160,
        "wires": [["debug_commands"]]
    },
    {
        "id": "debug_commands",
        "type": "debug",
        "z": "gcs_flow",
        "name": "Outgoing Commands",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 760,
        "y": 160,
        "wires": []
    },
    {
        "id": "safety_monitor_input",
        "type": "function",
        "z": "gcs_flow",
        "name": "Safety Monitor",
        "func": "// Simple safety monitoring\nif (msg.topic === 'SYS_STATUS') {\n    const battery = msg.payload.batteryRemaining || 0;\n    if (battery < 20) {\n        return {\n            payload: `âš ï¸ LOW BATTERY: ${battery}%`,\n            topic: 'safety/battery',\n            level: 'critical'\n        };\n    }\n}\n\nif (msg.topic === 'GPS_RAW_INT') {\n    const fixType = msg.payload.fixType || 0;\n    if (fixType < 3) {\n        return {\n            payload: `âš ï¸ GPS: No 3D fix!`,\n            topic: 'safety/gps',\n            level: 'warning'\n        };\n    }\n}\n\nreturn null;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "libs": [],
        "x": 360,
        "y": 460,
        "wires": [["ui_safety_alert"]]
    },
    {
        "id": "ui_safety_alert",
        "type": "ui_toast",
        "z": "gcs_flow",
        "position": "top right",
        "displayTime": "10",
        "highlight": "red",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "âš ï¸ SAFETY ALERT",
        "name": "Safety Alerts",
        "x": 580,
        "y": 460,
        "wires": []
    },
    {
        "id": "ui_armed_status",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "status_group",
        "order": 1,
        "width": 3,
        "height": 1,
        "name": "Armed",
        "label": "Armed",
        "format": "<span style=\"color:{{msg.color}};font-weight:bold;\">{{msg.payload}}</span>",
        "layout": "row-spread",
        "className": "",
        "x": 810,
        "y": 80,
        "wires": []
    },
    {
        "id": "ui_flight_mode",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "status_group",
        "order": 2,
        "width": 3,
        "height": 1,
        "name": "Mode",
        "label": "Mode",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 810,
        "y": 120,
        "wires": []
    },
    {
        "id": "ui_gps_status",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "status_group",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "GPS",
        "label": "GPS",
        "format": "<span style=\"color:{{msg.color}}\">{{msg.payload}}</span>",
        "layout": "row-spread",
        "className": "",
        "x": 810,
        "y": 160,
        "wires": []
    },
    {
        "id": "ui_latitude",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "position_group",
        "order": 1,
        "width": 3,
        "height": 1,
        "name": "Latitude",
        "label": "Lat",
        "format": "{{msg.payload}}Â°",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 200,
        "wires": []
    },
    {
        "id": "ui_longitude",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "position_group",
        "order": 2,
        "width": 3,
        "height": 1,
        "name": "Longitude",
        "label": "Lon",
        "format": "{{msg.payload}}Â°",
        "layout": "row-spread",
        "className": "",
        "x": 830,
        "y": 240,
        "wires": []
    },
    {
        "id": "ui_gps_altitude",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "position_group",
        "order": 3,
        "width": 3,
        "height": 1,
        "name": "GPS Alt",
        "label": "Alt (MSL)",
        "format": "{{msg.payload}} m",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 280,
        "wires": []
    },
    {
        "id": "ui_battery_gauge",
        "type": "ui_gauge",
        "z": "gcs_flow",
        "name": "Battery",
        "group": "telemetry_group",
        "order": 1,
        "width": 3,
        "height": 3,
        "gtype": "gage",
        "title": "Battery",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": ["#ca3838","#e6e600","#00b500"],
        "seg1": "20",
        "seg2": "50",
        "x": 820,
        "y": 320,
        "wires": []
    },
    {
        "id": "ui_voltage",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "telemetry_group",
        "order": 2,
        "width": 2,
        "height": 1,
        "name": "Voltage",
        "label": "Voltage",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 360,
        "wires": []
    },
    {
        "id": "ui_current",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "telemetry_group",
        "order": 3,
        "width": 2,
        "height": 1,
        "name": "Current",
        "label": "Current",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 400,
        "wires": []
    },
    {
        "id": "ui_altitude_gauge",
        "type": "ui_gauge",
        "z": "gcs_flow",
        "name": "Altitude",
        "group": "telemetry_group",
        "order": 4,
        "width": 3,
        "height": 3,
        "gtype": "gage",
        "title": "Altitude (AGL)",
        "label": "m",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": ["#00b500","#e6e600","#ca3838"],
        "seg1": "30",
        "seg2": "70",
        "x": 830,
        "y": 440,
        "wires": []
    },
    {
        "id": "ui_groundspeed",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "flight_data_group",
        "order": 1,
        "width": 3,
        "height": 1,
        "name": "Groundspeed",
        "label": "Speed",
        "format": "{{msg.payload}} km/h",
        "layout": "row-spread",
        "className": "",
        "x": 840,
        "y": 480,
        "wires": []
    },
    {
        "id": "ui_heading_gauge",
        "type": "ui_gauge",
        "z": "gcs_flow",
        "name": "Heading",
        "group": "flight_data_group",
        "order": 2,
        "width": 3,
        "height": 3,
        "gtype": "compass",
        "title": "Heading",
        "label": "Â°",
        "format": "{{value}}",
        "min": 0,
        "max": "360",
        "colors": ["#00b500","#e6e600","#ca3838"],
        "seg1": "120",
        "seg2": "240",
        "x": 830,
        "y": 520,
        "wires": []
    },
    {
        "id": "ui_throttle_gauge",
        "type": "ui_gauge",
        "z": "gcs_flow",
        "name": "Throttle",
        "group": "flight_data_group",
        "order": 3,
        "width": 3,
        "height": 3,
        "gtype": "gage",
        "title": "Throttle",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": ["#00b500","#e6e600","#ca3838"],
        "seg1": "30",
        "seg2": "70",
        "x": 830,
        "y": 560,
        "wires": []
    },
    {
        "id": "ui_climb_rate",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "flight_data_group",
        "order": 4,
        "width": 3,
        "height": 1,
        "name": "Climb Rate",
        "label": "Climb",
        "format": "{{msg.payload}} m/s",
        "layout": "row-spread",
        "className": "",
        "x": 830,
        "y": 600,
        "wires": []
    },
    {
        "id": "ui_roll",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "attitude_group",
        "order": 1,
        "width": 2,
        "height": 1,
        "name": "Roll",
        "label": "Roll",
        "format": "{{msg.payload}}Â°",
        "layout": "row-spread",
        "className": "",
        "x": 810,
        "y": 640,
        "wires": []
    },
    {
        "id": "ui_pitch",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "attitude_group",
        "order": 2,
        "width": 2,
        "height": 1,
        "name": "Pitch",
        "label": "Pitch",
        "format": "{{msg.payload}}Â°",
        "layout": "row-spread",
        "className": "",
        "x": 810,
        "y": 680,
        "wires": []
    },
    {
        "id": "ui_yaw",
        "type": "ui_text",
        "z": "gcs_flow",
        "group": "attitude_group",
        "order": 3,
        "width": 2,
        "height": 1,
        "name": "Yaw",
        "label": "Yaw",
        "format": "{{msg.payload}}Â°",
        "layout": "row-spread",
        "className": "",
        "x": 810,
        "y": 720,
        "wires": []
    },
    {
        "id": "comment_info",
        "type": "comment",
        "z": "gcs_flow",
        "name": "Complete GCS - Wire mavlink-comms â†’ 'MAVLink Hub', and 'Command Output' â†’ mavlink-msg",
        "info": "## Complete Ground Control Station\n\nFull-featured GCS combining all capabilities in one dashboard.\n\n### Setup:\n\n**Incoming Telemetry:**\n1. Wire mavlink-comms output â†’ 'MAVLink Hub' junction\n\n**Outgoing Commands:**\n2. Wire 'Command Output' junction â†’ mavlink-msg node (set to \"None (Dynamic)\")\n\n**Deploy and Launch:**\n3. Deploy the flow\n4. Open Dashboard: http://localhost:1880/ui\n5. You now have a complete ground control station!\n\n### Dashboard Layout:\n\nThe dashboard is organized into logical groups:\n\n**Controls (Top Left):**\n- ARM/DISARM buttons\n- TAKEOFF button (10m default)\n- LAND button\n- RTL (Return to Launch) button\n- Flight mode dropdown selector\n\n**Status Panel (Top Right):**\n- Armed/Disarmed status (color coded)\n- Current flight mode\n- GPS fix status with satellite count\n\n**Position Data:**\n- Latitude (decimal degrees)\n- Longitude (decimal degrees)\n- GPS Altitude (MSL)\n\n**Telemetry Gauges:**\n- Battery percentage (gauge)\n- Battery voltage\n- Battery current\n- Altitude above ground (gauge)\n\n**Flight Data:**\n- Groundspeed (km/h)\n- Heading (compass gauge)\n- Throttle (gauge)\n- Climb rate (m/s)\n\n**Attitude:**\n- Roll angle\n- Pitch angle\n- Yaw angle\n\n**Safety Alerts:**\n- Automatic low battery warnings (<20%)\n- GPS signal loss alerts\n- Pop-up toast notifications\n\n### Using the GCS:\n\n**Pre-Flight Checklist:**\n1. âœ… Verify GPS shows \"3D FIX\" or better\n2. âœ… Check battery >80% and voltage normal\n3. âœ… Confirm status shows \"DISARMED\"\n4. âœ… Set desired flight mode (usually STABILIZE or LOITER)\n5. âœ… ARM the vehicle\n6. âœ… Wait for \"ARMED\" status to appear in RED\n7. âœ… Click TAKEOFF (or use transmitter)\n\n**During Flight:**\n- Monitor battery percentage - land before 20%\n- Watch GPS status - maintain 3D fix\n- Check altitude stays within safe limits\n- Verify heading matches expected flight path\n- Monitor climb rate during altitude changes\n\n**Landing:**\n- Option 1: Click LAND button (lands at current position)\n- Option 2: Click RTL button (returns to launch point, then lands)\n- Option 3: Change mode to LAND via dropdown\n- Always monitor descent and be ready to abort if needed\n\n**Emergency:**\n- Red RTL button returns home immediately\n- DISARM button available (only use on ground!)\n- Safety alerts pop up automatically\n\n### Flight Modes:\n\n**Basic Modes:**\n- **STABILIZE** - Manual flight with self-leveling\n- **ALT_HOLD** - Hold altitude, manual horizontal control\n- **LOITER** - Hold position using GPS\n\n**Auto Modes:**\n- **GUIDED** - Accept external navigation commands\n- **AUTO** - Follow uploaded mission waypoints\n- **RTL** - Return to launch point automatically\n- **LAND** - Automatic landing at current position\n\n**Advanced:**\n- **POSHOLD** - Hold position, more aggressive than LOITER\n\n### Safety Features:\n\n**Automatic Monitoring:**\n- Battery level checked on every SYS_STATUS message\n- GPS quality validated continuously\n- Pop-up alerts for critical conditions\n\n**Thresholds:**\n- Battery <20% = CRITICAL alert\n- GPS fix type <3 = WARNING alert\n\n**Color Coding:**\n- **Red** = Danger/Armed/Critical\n- **Orange** = Warning\n- **Yellow** = Caution\n- **Green** = Good/Disarmed/Safe\n- **Blue** = Info/Action\n\n### Customization:\n\n**Change takeoff altitude:**\nEdit `btn_takeoff` payload, change `param7` value:\n```json\n{\"messageType\":\"COMMAND_LONG\",\"command\":22,\"param7\":20,\"target_system\":1,\"target_component\":1}\n```\n(This sets takeoff to 20m instead of 10m)\n\n**Add more flight modes:**\nEdit `ui_mode_selector` options to add modes like ACRO, SPORT, etc.\n\n**Adjust gauge ranges:**\nEdit gauge nodes (altitude, battery, etc.) to change min/max values and color segments.\n\n**Add custom commands:**\nCopy any button, change payload to desired MAVLink command.\n\n### Telemetry Requirements:\n\nFor full functionality, vehicle must send:\n- **HEARTBEAT** (1 Hz) - Armed status, flight mode\n- **SYS_STATUS** (1 Hz) - Battery, sensors\n- **GPS_RAW_INT** (1-5 Hz) - GPS status, position\n- **GLOBAL_POSITION_INT** (5 Hz) - Relative altitude\n- **VFR_HUD** (4 Hz) - Speed, heading, climb\n- **ATTITUDE** (10 Hz) - Roll, pitch, yaw\n\nMost ArduPilot vehicles send these by default on telemetry ports.\n\n### Performance:\n\n**Bandwidth:**\n- Incoming: ~5-10 KB/s typical\n- Outgoing: <1 KB/s (commands only)\n\n**Latency:**\n- Dashboard updates: ~100-500ms typical\n- Command execution: Immediate\n- Depends on telemetry link quality\n\n**Browser:**\n- Works best in Chrome/Chromium\n- Firefox also supported\n- Mobile browsers work but small screen\n\n### Troubleshooting:\n\n**No telemetry data:**\n- Verify mavlink-comms node shows \"connected\"\n- Check wiring to MAVLink Hub junction\n- Look for messages in debug panel\n- Verify vehicle is powered and transmitting\n\n**Commands don't work:**\n- Check Command Output â†’ mavlink-msg wiring\n- Verify mavlink-msg set to \"None (Dynamic)\"\n- Check debug panel for outgoing messages\n- Ensure vehicle is receiving commands\n\n**Dashboard blank:**\n- Install node-red-dashboard from Palette Manager\n- Open http://localhost:1880/ui (not editor)\n- Check browser console for errors\n- Verify all dashboard nodes configured\n\n**Gauges not updating:**\n- Check message routing in \"Route by Message Type\"\n- Verify parse functions output correct format\n- Watch debug panel for parsing errors\n- Confirm messages arriving at hub\n\n### Extending the GCS:\n\nThis is a foundation - you can add:\n\n**More Controls:**\n- Gimbal control\n- Camera trigger\n- Servo outputs\n- Relay switches\n- Parameter adjustments\n\n**More Telemetry:**\n- Wind speed/direction\n- Rangefinder data\n- RC input values\n- Motor outputs\n- Vibration levels\n\n**Advanced Features:**\n- Mission planning\n- Geofence setup\n- Rally point configuration\n- Log downloading\n- Video streaming\n\n**Integration:**\n- SMS alerts on events\n- Email notifications\n- Database logging\n- Web API for mobile apps\n- Voice announcements\n\n### Safety Reminders:\n\nâš ï¸ **This is a TOOL, not a replacement for safe practices!**\n\n**Always:**\n- âœ… Maintain visual line of sight\n- âœ… Have manual RC override ready\n- âœ… Know how to disarm quickly\n- âœ… Check local regulations\n- âœ… Fly in safe areas only\n- âœ… Monitor battery closely\n- âœ… Have emergency plan\n\n**Never:**\n- âŒ Fly beyond visual range without authorization\n- âŒ Rely solely on automation\n- âŒ Ignore safety alerts\n- âŒ Fly with low battery\n- âŒ Fly in bad weather\n- âŒ Fly near people/airports without permission\n\n### Requirements:\n- node-red-dashboard installed\n- mavlink-comms node configured and connected\n- Vehicle sending standard MAVLink telemetry\n- Stable bidirectional communication\n\n---\n\n## You Did It! ðŸŽ‰\n\nYou now have a fully functional ground control station built entirely in Node-RED!\n\nEnjoy flying, stay safe, and happy hacking! ðŸš",
        "x": 310,
        "y": 20,
        "wires": []
    },
    {
        "id": "control_group",
        "type": "ui_group",
        "name": "Flight Controls",
        "tab": "gcs_tab",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "status_group",
        "type": "ui_group",
        "name": "Status",
        "tab": "gcs_tab",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "position_group",
        "type": "ui_group",
        "name": "Position",
        "tab": "gcs_tab",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "telemetry_group",
        "type": "ui_group",
        "name": "Telemetry",
        "tab": "gcs_tab",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "flight_data_group",
        "type": "ui_group",
        "name": "Flight Data",
        "tab": "gcs_tab",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "attitude_group",
        "type": "ui_group",
        "name": "Attitude",
        "tab": "gcs_tab",
        "order": 6,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "gcs_tab",
        "type": "ui_tab",
        "name": "Ground Control Station",
        "icon": "flight",
        "order": 1,
        "disabled": false,
        "hidden": false
    }
]
